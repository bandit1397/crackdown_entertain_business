<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>풍속업소 단속 시스템 개선판</title>

<style>
body{
  font-family:"Apple SD Gothic Neo",sans-serif;
  margin:20px;
}
.box{
  border:1px solid #aaa;
  padding:15px;
  margin-bottom:20px;
  border-radius:8px;
}
button{
  width:100%;
  padding:8px;
  margin-top:5px;
  font-size:15px;
  cursor:pointer;
}
#industryButtons{
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  grid-gap: 8px;
}
#violationsArea{
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  grid-gap: 8px;
}

button.activeIndustry{
  background:#1e90ff;
  color:white;
}

button.activeViolation{
  background:#ff4d4d;
  color:white;
}

#punishList{
  background:#f5f5f5;
  padding:10px;
  border-radius:6px;
}
.item{
  border-bottom:1px solid #ccc;
  padding:6px 0;
}
.hidden{display:none;}

.depth{
  display:block;
  margin-bottom:3px;
}

</style>
</head>
<body>

<h2>풍속업소 단속 시스템</h2>

<!-- 1단계 -->
<div class="box">
  <strong>1. 업종 선택</strong>
  <div id="industryButtons">
      <button onclick="selectIndustry('유흥주점', event)">유흥주점</button>
      <button onclick="selectIndustry('단란주점', event)">단란주점</button>
      <button onclick="selectIndustry('일반음식점', event)">일반음식점</button>
      <button onclick="selectIndustry('노래연습장', event)">노래연습장</button>
      <button onclick="selectIndustry('이용업', event)">이용업</button>
      <button onclick="selectIndustry('숙박업', event)">숙박업</button>
      <button onclick="selectIndustry('목욕장업', event)">목욕장업</button>
      <button onclick="selectIndustry('게임제공업', event)">게임제공업</button>
  </div>
</div>


<!-- 2단계 -->
<div class="box">
  <strong>2. 위반 유형 선택</strong>
  <div id="violationsArea">업종을 먼저 선택하세요</div>
</div>


<!-- 3단계 -->
<div class="box">
  <strong>3. 처벌조항 / 유의사항</strong>
  <div id="punishList">항목을 선택하세요</div>
</div>



<script src="data.js"></script>
<script>
   
function selectIndustry(name, e){

  if(e.target.classList.contains("activeIndustry")){
      resetIndustries();
      return;
  }

  document.querySelectorAll("#industryButtons button")
  .forEach(b=>{
    if(b !== e.target){ b.classList.add("hidden"); }
  });

  e.target.classList.add("activeIndustry");

  loadViolations(name);
}



function resetIndustries(){
  
  document.querySelectorAll("#industryButtons button").forEach(b=>{
      b.classList.remove("hidden");
      b.classList.remove("activeIndustry");
  });

  document.getElementById("violationsArea").innerHTML = "업종을 먼저 선택하세요";
  document.getElementById("punishList").innerHTML = "항목을 선택하세요";
}




function loadViolations(industry){

  let area = document.getElementById("violationsArea");
  let punish = document.getElementById("punishList");

  area.innerHTML = "";
  punish.innerHTML = "항목을 선택하세요";

  if(!data[industry]){
    area.innerHTML = "자료 없음";
    return;
  }

  data[industry].forEach(v=>{

    let btn = document.createElement("button");
    btn.innerText = v.name.text;

    btn.dataset.name = v.name.text;
    btn.classList.add("vioBtn");

    btn.onclick=function(){
      toggleViolation(btn, v);
    };

    area.appendChild(btn);
  })
}




function toggleViolation(btn, obj){

  let punishBox = document.getElementById("punishList");
  let id = obj.name.text;

  if(btn.classList.contains("activeViolation")){

      btn.classList.remove("activeViolation");

      let target = document.getElementById("pun_"+id);
      if(target) target.remove();

      if(document.querySelectorAll(".activeViolation").length === 0){
        punishBox.innerHTML="항목을 선택하세요";
      }

      return;
  }

  btn.classList.add("activeViolation");

  if(punishBox.innerText==="항목을 선택하세요"){
      punishBox.innerHTML = "";
  }

  let html = `<div class="item" id="pun_${id}">`;

  // NAME
  html += `
      <span class="depth" style="margin-left:${obj.name.depth*20}px;">
        <strong>${obj.name.text}</strong>
      </span>
  `;


  // 법조문 상위 제목
  html += `
      <span class="depth" style="margin-left:${20}px;">
        <strong>법조문</strong>
      </span>
  `;

  // 법조문 반복 출력
  obj.law.forEach(l=>{
      html += `
        <span class="depth" style="margin-left:${l.depth*20}px;">
          ${l.text}
        </span>
      `;
  });


  // 처벌 상위
  html += `
      <span class="depth" style="margin-left:${20}px;">
        <strong>처벌</strong>
      </span>
  `;

  obj.penalty.forEach(p=>{
      html += `
        <span class="depth" style="margin-left:${p.depth*20}px;">
          ${p.text}
        </span>
      `;
  });


  // 유의사항 상위
  html += `
      <span class="depth" style="margin-left:${20}px;">
        <strong>유의사항</strong>
      </span>
  `;

  obj.note.forEach(n=>{
     html += `
        <span class="depth" style="margin-left:${n.depth*20}px;">
          ${n.text}
        </span>
     `;
  });

  html += "</div>";

  punishBox.innerHTML += html;
}


</script>

</body>
</html>
