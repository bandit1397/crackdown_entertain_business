<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í’ì†ì—…ì†Œ ë‹¨ì† ì‹œìŠ¤í…œ ê°œì„ íŒ</title>

<style>
body{
  font-family:"Apple SD Gothic Neo",sans-serif;
  margin:20px;
}
.box{
  border:1px solid #aaa;
  padding:15px;
  margin-bottom:20px;
  border-radius:8px;
}
button{
  width:100%;
  padding:8px;
  margin-top:5px;
  font-size:15px;
  cursor:pointer;
}
#industryButtons{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  grid-gap: 8px;
}
#violationsArea{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  grid-gap: 8px;
}

button.activeIndustry{
  background:#1e90ff;
  color:white;
}

button.activeViolation{
  background:#ff4d4d;
  color:white;
}

#punishList{
  background:#f5f5f5;
  padding:10px;
  border-radius:6px;
}
.item{
  border-bottom:1px solid #ccc;
  padding:6px 0;
}
.hidden{display:none;}

.depth{
  display:block;
  margin-bottom:3px;
}



/* ============================
   ğŸ“± ìŠ¤ë§ˆíŠ¸í° ëŒ€ì‘ ë°˜ì‘í˜•
============================ */
@media(max-width:900px){

  body{
    margin:10px;
    font-size:15px;
  }

  h2{
    font-size:20px;
  }

  #industryButtons,
  #violationsArea{
    grid-template-columns: repeat(2, 1fr);
    grid-gap:6px;
  }

  button{
    padding:12px;
    font-size:14px;
  }

  .box{
    padding:12px;
  }

  #punishList{
    font-size:14px;
  }
}


/* ============================
   ğŸ“± ì‘ì€ ëª¨ë°”ì¼ í•´ìƒë„ ëŒ€ì‘
============================ */
@media(max-width:520px){

  #industryButtons,
  #violationsArea{
    grid-template-columns: repeat(1, 1fr);
  }

  button{
    font-size:15px;
    padding:14px;
  }

  .depth{
    font-size:14px;
  }

  h2{
    font-size:19px;
  }
}

</style>
</head>
<body>

<h2 style="text-align:center; margin-top:0; padding:1rem 0; font-size:1.8rem;">í’ì†ì—…ì†Œ ë‹¨ì† ë©”ë‰´ì–¼</h2>

<!-- 1ë‹¨ê³„ -->
<div class="box">
  <strong>1. ì—…ì¢… ì„ íƒ</strong>
  <div id="industryButtons">
      <button onclick="selectIndustry('ìœ í¥ì£¼ì ', event)">ìœ í¥ì£¼ì </button>
      <button onclick="selectIndustry('ë‹¨ë€ì£¼ì ', event)">ë‹¨ë€ì£¼ì </button>
      <button onclick="selectIndustry('ì¼ë°˜ìŒì‹ì ', event)">ì¼ë°˜ìŒì‹ì </button>
      <button onclick="selectIndustry('ë…¸ë˜ì—°ìŠµì¥', event)">ë…¸ë˜ì—°ìŠµì¥</button>
      <button onclick="selectIndustry('ì´ìš©ì—…', event)">ì´ìš©ì—…</button>
      <button onclick="selectIndustry('ìˆ™ë°•ì—…', event)">ìˆ™ë°•ì—…</button>
      <button onclick="selectIndustry('ëª©ìš•ì¥ì—…', event)">ëª©ìš•ì¥ì—…</button>
      <button onclick="selectIndustry('ê²Œì„ì œê³µì—…', event)">ê²Œì„ì œê³µì—…</button>
      <button onclick="selectIndustry('ë‹¹êµ¬ì¥Â·ìŠ¤í¬ë¦°ê³¨í”„ì¥Â·í¬ë ˆì¸', event)">ë‹¹êµ¬ì¥Â·ìŠ¤í¬ë¦°ê³¨í”„ì¥Â·í¬ë ˆì¸</button>
  </div>
</div>


<!-- 2ë‹¨ê³„ -->
<div class="box">
  <strong>2. ìœ„ë°˜ ìœ í˜• ì„ íƒ</strong>
  <div id="violationsArea">ì—…ì¢…ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</div>
</div>


<!-- 3ë‹¨ê³„ -->
<div class="box">
  <strong>3. ì²˜ë²Œì¡°í•­ / ìœ ì˜ì‚¬í•­</strong>
  <div id="punishList">í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”</div>
</div>



<script src="data.js"></script>
<script>
  
function makeLawUrl(text){
  const lawMatch = text.match(/^(.+?)\sì œ/);
  const articleMatch = text.match(/ì œ\d+ì¡°/);

  if(!lawMatch || !articleMatch) return null;

  const lawName = lawMatch[1].trim();
  const article = articleMatch[0];

  return `https://law.go.kr/ë²•ë ¹/${encodeURIComponent(lawName)}/${article}`;
}

   
function selectIndustry(name, e){

  if(e.target.classList.contains("activeIndustry")){
      resetIndustries();
      return;
  }

  document.querySelectorAll("#industryButtons button")
  .forEach(b=>{
    if(b !== e.target){ b.classList.add("hidden"); }
  });

  e.target.classList.add("activeIndustry");

  loadViolations(name);
}



function resetIndustries(){
  
  document.querySelectorAll("#industryButtons button").forEach(b=>{
      b.classList.remove("hidden");
      b.classList.remove("activeIndustry");
  });

  document.getElementById("violationsArea").innerHTML = "ì—…ì¢…ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”";
  document.getElementById("punishList").innerHTML = "í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”";
}




function loadViolations(industry){

  let area = document.getElementById("violationsArea");
  let punish = document.getElementById("punishList");

  area.innerHTML = "";
  punish.innerHTML = "í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”";

  if(!data[industry]){
    area.innerHTML = "ìë£Œ ì—†ìŒ";
    return;
  }

  data[industry].forEach(v=>{

    let btn = document.createElement("button");
    btn.innerText = v.name.text;

    btn.dataset.name = v.name.text;
    btn.classList.add("vioBtn");

    btn.onclick=function(){
      toggleViolation(btn, v);
    };

    area.appendChild(btn);
  })
}




function toggleViolation(btn, obj){

  let punishBox = document.getElementById("punishList");
  let id = obj.name.text;

  if(btn.classList.contains("activeViolation")){

      btn.classList.remove("activeViolation");

      let target = document.getElementById("pun_"+id);
      if(target) target.remove();

      if(document.querySelectorAll(".activeViolation").length === 0){
        punishBox.innerHTML="í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”";
      }

      return;
  }

  btn.classList.add("activeViolation");

  if(punishBox.innerText==="í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”"){
      punishBox.innerHTML = "";
  }

  let html = `<div class="item" id="pun_${id}">`;

  html += `
      <span class="depth" style="margin-left:${obj.name.depth*20}px;">
        <strong>${obj.name.text}</strong>
      </span>
  `;

  html += `
      <span class="depth" style="margin-left:${20}px;">
        <strong>ì²˜ë²Œ</strong>
      </span>
  `;

  obj.penalty.forEach(p=>{
      html += `
        <span class="depth" style="margin-left:${p.depth*20}px;">
          ${p.text}
        </span>
      `;
  });

  html += `
      <span class="depth" style="margin-left:${20}px;">
        <strong>ë²•ì¡°ë¬¸</strong>
      </span>
  `;

  obj.law.forEach(l=>{
    const url = makeLawUrl(l.text);

    if(url){
      html += `
        <span class="depth" style="margin-left:${l.depth*20}px;">
           <a href="${url}" target="_blank"
               style="color:#1e90ff;font-weight:600;text-decoration:underline;">
            ${l.text}
          </a>
        </span>
      `;
    } else {
      html += `
        <span class="depth" style="margin-left:${l.depth*20}px;">
          ${l.text}
        </span>
      `;
    }
  });



  html += `
      <span class="depth" style="margin-left:${20}px;">
        <strong>ìœ ì˜ì‚¬í•­</strong>
      </span>
  `;

  obj.note.forEach(n=>{
     html += `
        <span class="depth" style="margin-left:${n.depth*20}px;">
          ${n.text}
        </span>
     `;
  });

  html += "</div>";

  punishBox.innerHTML += html;
}

</script>

</body>
</html>
