<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>풍속업소 단속 시스템 개선판</title>

<style>
body{
  font-family:"Apple SD Gothic Neo",sans-serif;
  margin:20px;
}
.box{
  border:1px solid #aaa;
  padding:15px;
  margin-bottom:20px;
  border-radius:8px;
}
button{
  width:100%;
  padding:8px;
  margin-top:5px;
  font-size:15px;
  cursor:pointer;
}
#industryButtons{
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  grid-gap: 8px;
}
#violationsArea{
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  grid-gap: 8px;
}

button.activeIndustry{
  background:#1e90ff;
  color:white;
}

button.activeViolation{
  background:#ff4d4d;
  color:white;
}

#punishList{
  background:#f5f5f5;
  padding:10px;
  border-radius:6px;
}
.item{
  border-bottom:1px solid #ccc;
  padding:6px 0;
}
.hidden{display:none;}

</style>
</head>
<body>

<h2>풍속업소 단속 시스템</h2>

<!-- 1단계 -->
<div class="box">
  <strong>1. 업종 선택</strong>
  <div id="industryButtons">
      <button onclick="selectIndustry('유흥주점', event)">유흥주점</button>
      <button onclick="selectIndustry('단란주점', event)">단란주점</button>
      <button onclick="selectIndustry('일반음식점', event)">일반음식점</button>
      <button onclick="selectIndustry('노래연습장', event)">노래연습장</button>
      <button onclick="selectIndustry('이용업', event)">이용업</button>
      <button onclick="selectIndustry('숙박업', event)">숙박업</button>
      <button onclick="selectIndustry('목욕장업', event)">목욕장업</button>
      <button onclick="selectIndustry('게임제공업', event)">게임제공업</button>
  </div>
</div>


<!-- 2단계 -->
<div class="box">
  <strong>2. 위반 유형 선택</strong>
  <div id="violationsArea">업종을 먼저 선택하세요</div>
</div>


<!-- 3단계 -->
<div class="box">
  <strong>3. 처벌조항 / 유의사항</strong>
  <div id="punishList">항목을 선택하세요</div>
</div>



<script>

/********************
★ DB
********************/
const data = {

"유흥주점":[
{ name:"호객행위", law:"경범죄처벌법", penalty:"10만원 이하 벌금", note:"현장영상 확보" },
{ name:"무허가 영업", law:"식품위생법 제44조", penalty:"3년 이하 징역", note:"영업신고증 확인" },
{ name:"미검진 종업원", law:"후천성면역예방법", penalty:"300만원 이하", note:"위생검진표 필요" },
{ name:"접객부 명부 미작성", law:"식품위생법 시행규칙", penalty:"영업정지 가능", note:"명부 확인" }
],

"단란주점":[
{ name:"무허가 영업", law:"식품위생법 제44조", penalty:"3년 이하 징역", note:"간판 확인" }
]

};



/********************
업종 토글 기능 추가
********************/
let selectedIndustry = null;

function selectIndustry(name, e){

  let allBtns = document.querySelectorAll("#industryButtons button");
  let area = document.getElementById("violationsArea");
  let punish = document.getElementById("punishList");


  /** 선택 해제 **/
  if(selectedIndustry === name){

      selectedIndustry = null;

      allBtns.forEach(b=>{
        b.classList.remove("hidden");
        b.classList.remove("activeIndustry");
      });

      area.innerHTML = "업종을 먼저 선택하세요";
      punish.innerHTML = "항목을 선택하세요";

      return;
  }


  /** 업종 선택 **/
  selectedIndustry = name;

  allBtns.forEach(btn=>{

      if(btn.innerText === name){
          btn.classList.add("activeIndustry");
          btn.classList.remove("hidden");
      }else{
          btn.classList.add("hidden");
          btn.classList.remove("activeIndustry");
      }

  });

  loadViolations(name);

}






/********************
2. 위반목록 출력 그대로 유지
********************/
function loadViolations(industry){

  let area = document.getElementById("violationsArea");
  let punish = document.getElementById("punishList");

  area.innerHTML = "";
  punish.innerHTML = "항목을 선택하세요";

  if(data[industry] === undefined){
    area.innerHTML = "자료 없음";
    return;
  }

  data[industry].forEach(v=>{

    let btn = document.createElement("button");
    btn.innerText = v.name;

    btn.dataset.name = v.name;
    btn.classList.add("vioBtn");

    btn.onclick=function(){
      toggleViolation(btn, v);
    };

    area.appendChild(btn);

  })
}




/********************
3. 위반 항목 토글 그대로 유지
********************/
function toggleViolation(btn, obj){

  let punishBox = document.getElementById("punishList");
  let id = obj.name;

  if(btn.classList.contains("activeViolation")){

      btn.classList.remove("activeViolation");

      let target = document.getElementById("pun_"+id);
      if(target){ target.remove(); }

      if(document.querySelectorAll(".activeViolation").length === 0){
        punishBox.innerHTML = "항목을 선택하세요";
      }

      return;
  }


  btn.classList.add("activeViolation");

  if(punishBox.innerText === "항목을 선택하세요"){
      punishBox.innerHTML = "";
  }

  punishBox.innerHTML += `
  <div class="item" id="pun_${id}">
    <strong>${obj.name}</strong><br>
    법조문: ${obj.law}<br>
    처벌: ${obj.penalty}<br>
    유의사항: ${obj.note}
  </div>
  `;

}

</script>

</body>
</html>
